---
platform: linux

inputs:
- name: service-account-tf
- name: bbl-state

outputs:
- name: bbl-state

run:
  path: bash
  args:
  - -euc
  - |
    jq -r '.service_account_key' service-account-tf/metadata | base64 --decode > bbl-state/gcreds.json
    jq -r '.certificate' service-account-tf/metadata > bbl-state/tls_cert
    jq -r '.private_key' service-account-tf/metadata > bbl-state/tls_key
